---
title: "index"
subtitle: "Link to Data Source https://usa.ipums.org/usa/"
author: "Benjamin Reese and Sarah Hayes"
format: html
---

```{r, warning=FALSE, message=FALSE}
library(readr)
acs <- read_csv("usa_00003.csv")
library(tidyverse)
```


## Figure One
Figure one examines the income distribution by racial category. As the figure shows, all racial groups have a higher distribution of incomes closer to the poverty line. However, American Indians (Indigenous) have a larger amount of people closer to the poverty line, whereas for Asian Americans, they have the highest distribution of incomes. 
```{r, warning = FALSE, message = FALSE}
acs %>%
  filter(INCTOT < 200000 & INCTOT !=0 ) %>%
  mutate(Race = case_when(
    RACE == 1 ~ "White",
    RACE == 2 ~ "Black",
    RACE == 3 ~ "American Indian",
    RACE == 4 | RACE == 5 | RACE == 6 ~ "Asian or P I",
    RACE > 6 ~ "Other"
    )) %>%
  ggplot(aes(Race, INCTOT)) +
  geom_violin(col="blue", fill="light blue") +
  theme_minimal() +
  labs(x=NULL, y="Income",
          title = "The Distribution of Income Is Largely Consistent Between Races",
          subtitle = "Income by Race for Americans",
          caption = "Data Source: IPUMS 2019 ACS")
```


## Figure Two

Continuing with Figure Two, poverty line is broken down by racial and sex categories. Similar to figure one, there is a relative equal distribution between genders of each racial groups. Poverty between men and women remain similar between one another for each racial group. Similar to figure one, average poverty for Asian Americans is lower for both men and women amongst the racial groups, while Indigenous Americans and Black American are closer to the poverty line compared to the other groups.

```{r, warning=FALSE, message=FALSE}

acs %>%
  filter(POVERTY > 0) %>%
  mutate(Race = case_when( ## creating new race variable
    RACE == 1 ~ "White",
    RACE == 2 ~ "Black",
    RACE == 3 ~ "American Indian",
    RACE == 4 | RACE == 5 | RACE == 6 ~ "Asian or P I",
    RACE > 6 ~ "Other"
  )) %>%
  mutate(Sex = case_when( ## creating new sex variable
    SEX == 1 ~ "Male",
    SEX == 2 ~ "Female",
  )) %>%
  ggplot(aes(Race, POVERTY, fill=Sex)) +
  geom_boxplot() + 
  theme_minimal() +
  labs(y="Income as Percent of Poverty Level", x=NULL,
       title = "Wages as Percent of Poverty Level Shows Variation in Income by Race",
       subtitle = "Asian or P I Have Average Incomes Far Above Poverty Level",
       caption = "Data Source: IPUMS 2019 ACS")
```

